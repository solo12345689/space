<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Unity WebGL</title>

<style>
body {
  margin: 0;
  padding: 0;
  background: #000;
}

#unity-container {
  width: 100vw;
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
}

#unity-canvas {
  width: 100%;
  height: 100%;
  background: #000;
}
</style>

<!-- ===== UNITY 6000 WEBGL2 CRITICAL FIX ===== -->
<script>
// Global stub
window.getContextSafariWebGL2Fixed = function() {
  return HTMLCanvasElement.prototype.getContext.apply(this, arguments);
};

// Prototype patch
if (!HTMLCanvasElement.prototype.getContextSafariWebGL2Fixed) {
  HTMLCanvasElement.prototype.getContextSafariWebGL2Fixed = function() {
    return HTMLCanvasElement.prototype.getContext.apply(this, arguments);
  };
}

// Intercept getContext
const __origGetContext = HTMLCanvasElement.prototype.getContext;

HTMLCanvasElement.prototype.getContext = function(type) {

  if (type === "webgl2" || type === "webgl") {
    return __origGetContext.apply(this, arguments);
  }

  if (type === "experimental-webgl") {
    return __origGetContext.call(this, "webgl", arguments[1]);
  }

  return __origGetContext.apply(this, arguments);
};
</script>
<!-- ===== END FIX ===== -->

</head>

<body>

<div id="unity-container">
  <canvas id="unity-canvas"></canvas>
</div>

<script src="81bbae32c7a77bc49304934b19e72883.loader.js"></script>

<script>
var buildUrl = ".";

var config = {
  dataUrl: "e4aa851098e3e5d328e4d879078ad6c5.data.br",
  frameworkUrl: "f3dc87e8bc321dd382fbd3fa53e1091f.framework.js.br",
  codeUrl: "9adf8a1aafea4c2333e26d66a8b36d56.wasm.br",

  streamingAssetsUrl: "StreamingAssets",

  companyName: "Unity",
  productName: "UnityGame",
  productVersion: "1.0",

  devicePixelRatio: window.devicePixelRatio || 1,
};

var canvas = document.querySelector("#unity-canvas");

createUnityInstance(canvas, config, (progress) => {
  console.log("Loading: " + Math.round(progress * 100) + "%");
}).then((unityInstance) => {
  console.log("Unity Loaded");
}).catch((message) => {
  console.error(message);
});
</script>

</body>
</html>
